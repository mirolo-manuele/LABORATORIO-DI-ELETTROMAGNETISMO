import ROOT
from array import array
import numpy as np
import pandas as pd

df = pd.read_excel("prova1.xlsx", sheet_name="Sheet1") #legge il file excel
df = df.dropna(subset=["Vsqrt", "I"]) #controlla solo le colonne V e I. Se una di queste contiene un valore mancante, elimina quella riga

Vsqrt = array('d', df["Vsqrt"].to_numpy(dtype=float)) #df è il dataframe, "V" è il nome della colonna da leggere 
I = array('d', df["I"].to_numpy(dtype=float)) #to_numpy converte la colonna in un array NumPy di tipo float.

eV = array('d', df["eV"].to_numpy(dtype=float))
eI = array('d', df["eI"].to_numpy(dtype=float))

c = ROOT.TCanvas("c", "Curva voltammetrica", 800, 600)

g=ROOT.TGraphErrors(len(Vsqrt), Vsqrt, I, eV, eI)

g.SetTitle("Curva voltammetrica;sqrt(V)[mV];I[mA]") 
g.SetMarkerStyle(21) 
g.SetMarkerColor(ROOT.kBlue) 
g.SetMarkerSize(0.5) 
g.SetLineColor(ROOT.kRed) 
g.SetLineWidth(1) 

g.Draw("APL")
c.Modified() 
c.Update()
c.Draw()
c.SaveAs("curva voltammetrica sqrt.png") 
input("Premi Invio per chiudere...") 